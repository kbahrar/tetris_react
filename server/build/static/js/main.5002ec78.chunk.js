(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{37:function(e,t,n){e.exports=n(52)},42:function(e,t,n){},43:function(e,t,n){},52:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(25),c=n.n(o),l=(n(42),n(43),n(1)),u=n(2),i=function(){return{type:"MOVE_LEFT"}},s=function(){return{type:"MOVE_RIGHT"}},m=function(){return{type:"ROTATE"}},d=function(){return{type:"MOVE_DOWN"}},v=function(){return{type:"DROP"}},f=function(e){return{type:"UPDATE",payload:e}},p=function(e){return{type:"ADDOP",payload:e}},E=function(e){return{type:"ERROR",payload:e}};var O=function(e){var t=Object(l.c)((function(e){return e.socket})),n=Object(l.c)((function(e){return e.auth})),r=Object(l.c)((function(e){var t;return null===(t=e.auth)||void 0===t?void 0:t.opponent})),o=(Object(l.c)((function(e){return e.room})),Object(l.b)());return Object(a.useEffect)((function(){t&&(t.on("connected",(function(e){o({type:"NoERROR"}),o({type:"AUTH_LOGIN",payload:e}),t.emit("list room")})),t.on("list room",(function(e){o(function(e){return{type:"ROOMS",payload:e}}(e))})),t.on("room joined",(function(e){o(function(e){return{type:"ROOM",payload:e}}(e))})),t.on("error",(function(e){o(E(e))})),t.on("users",(function(e){o(function(e){return{type:"USERS",payload:e}}(e))})),t.on("msg room",(function(e){o(function(e){return{type:"MSGROOM",payload:e}}(e))})),t.on("msg game",(function(e){o(function(e){return{type:"MSGS",payload:e}}(e))})),t.on("game started",(function(e){o(f(e))})),t.on("player exited",(function(){t.emit("get room")})))}),[t]),Object(a.useEffect)((function(){return t&&t.on("piece moved",(function(e,t){console.log(r),(null===n||void 0===n?void 0:n.name)===t?o(f(e)):r===t&&o(function(e){return{type:"UPDATEOP",payload:e}}(e))})),function(){t&&t.off("piece moved")}}),[t,n,r]),e.children};function g(e){var t="";return t=(null===e||void 0===e?void 0:e.shadow)?"grid-square color-".concat(e.color,"-shadow"):"".concat(e.classe," color-").concat(e.color),r.a.createElement("div",{className:t})}var b=n(22),h=function(){return e=1,t=T.length-1,Math.floor(Math.random()*(t-e+1))+e;var e,t},y=function(){return{grid:Array.from({length:20},(function(){return Array(10).fill(0)})),shape:0,rotation:0,x:5,y:-2,nextShape:0,isRunning:!1,score:0,speed:1e3,gameOver:!1,yShadow:-2,isWin:!0}},N=function(e,t){return(t+1)%T[e].length},j=function(e,t,n,a,r){for(var o=T[e][r],c=0;c<o.length;c++)for(var l=0;l<o[c].length;l++)if(0!==o[c][l]){var u=l+n,i=c+a;if(i<0)continue;var s=t[i];if(!s)return!1;if(void 0===s[u]||0!==s[u])return!1}return!0},R=function(e,t,n,a,r){for(var o=!1,c=T[e][r],l=Object(b.a)(t),u=0;u<c.length;u++)for(var i=0;i<c[u].length;i++){if(c[u][i])u+a<0?o=!0:l[u+a][i+n]=e}return{grid:l,gameOver:o}},S=function(e){for(var t=0,n=0;n<e.length;n++)-1===e[n].indexOf(0)&&(t++,e.splice(n,1),e.unshift(Array(10).fill(0)));return[0,40,100,300,1200][t]},T=[[[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]],[[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]]],[[[0,0,0,0],[1,1,1,0],[0,1,0,0],[0,0,0,0]],[[0,1,0,0],[1,1,0,0],[0,1,0,0],[0,0,0,0]],[[0,1,0,0],[1,1,1,0],[0,0,0,0],[0,0,0,0]],[[0,1,0,0],[0,1,1,0],[0,1,0,0],[0,0,0,0]]],[[[0,0,0,0],[1,1,1,0],[1,0,0,0],[0,0,0,0]],[[1,1,0,0],[0,1,0,0],[0,1,0,0],[0,0,0,0]],[[0,0,1,0],[1,1,1,0],[0,0,0,0],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[0,1,1,0],[0,0,0,0]]],[[[1,0,0,0],[1,1,1,0],[0,0,0,0],[0,0,0,0]],[[0,1,1,0],[0,1,0,0],[0,1,0,0],[0,0,0,0]],[[0,0,0,0],[1,1,1,0],[0,0,1,0],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[1,1,0,0],[0,0,0,0]]],[[[0,0,0,0],[1,1,0,0],[0,1,1,0],[0,0,0,0]],[[0,0,1,0],[0,1,1,0],[0,1,0,0],[0,0,0,0]]],[[[0,0,0,0],[0,1,1,0],[1,1,0,0],[0,0,0,0]],[[0,1,0,0],[0,1,1,0],[0,0,1,0],[0,0,0,0]]],[[[0,1,1,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]]]];function k(e){var t=Object(l.c)((function(e){return e.game})),n=t.grid,a=t.shape,o=t.rotation,c=t.x,u=t.y,i=t.yShadow,s=T[a][o],m=a;console.log(i);var d=null===n||void 0===n?void 0:n.map((function(e,t){return null===e||void 0===e?void 0:e.map((function(e,a){var o=a-c,l=t-u,d=t-i+1,v=!1,f=e;o>=0&&o<(null===s||void 0===s?void 0:s.length)&&l>=0&&l<(null===s||void 0===s?void 0:s.length)?f=0===s[l][o]?f:m:o>=0&&o<(null===s||void 0===s?void 0:s.length)&&d>=0&&d<(null===s||void 0===s?void 0:s.length)&&(f=0===s[d][o]?f:m,v=0!==s[d][o]);var p=t*n[0].length+a;return r.a.createElement(g,{key:p,classe:f>0?"grid-square-color":"grid-square",shadow:v,color:f})}))}));return r.a.createElement("div",{className:"grid-board"},d)}var C=n(8);function w(e){var t=Object(l.b)(),n=Object(l.c)((function(e){return e.auth})),a=Object(l.c)((function(e){var t;return null===(t=e.room)||void 0===t?void 0:t.players})),o=r.a.useState(null===n||void 0===n?void 0:n.opponent),c=Object(C.a)(o,2),u=c[0],i=c[1],s=Object(l.c)((function(e){return e.room})),m=document.querySelector("#select"),d=null===a||void 0===a?void 0:a.map((function(e){if(e!==(null===n||void 0===n?void 0:n.name))return r.a.createElement("option",{key:e,value:e},e)}));return r.a.useEffect((function(){(null===n||void 0===n?void 0:n.opponent)||s&&(null===s||void 0===s?void 0:s.players.length)>1&&!(null===n||void 0===n?void 0:n.opponent)&&s.players.map((function(e){e!==(null===n||void 0===n?void 0:n.name)&&t(p(e))}))}),[n,s]),r.a.createElement("select",{className:"select-dev",id:"select",value:u,onChange:function(e){m.blur(),u!==e.target.value&&(i(e.target.value),t({type:"RESETOP"}),t(p(e.target.value)))}},d)}function D(e){var t=Object(l.c)((function(e){return e.opGame})),n=t.grid,a=t.shape,o=t.rotation,c=t.x,u=t.y,i=t.gameOver,s=t.isWin,m=T[a][o],d=a,v=null===n||void 0===n?void 0:n.map((function(e,t){return null===e||void 0===e?void 0:e.map((function(e,a){var o=a-c,l=t-u,i=e;o>=0&&o<(null===m||void 0===m?void 0:m.length)&&l>=0&&l<(null===m||void 0===m?void 0:m.length)&&(i=0===m[l][o]?i:d);var s=t*n[0].length+a;return r.a.createElement(g,{key:s,classe:i>0?"grid-square-color-opo":"grid-square-opo",shadow:!1,color:i})}))}));return r.a.createElement("div",{className:"opponent-dev"},r.a.createElement("div",{className:"header-opponent"},"Opponent"),r.a.createElement(w,null),i||s?s?r.a.createElement("div",{className:"Winner"},"Winner !"):r.a.createElement("div",{className:"Game_Over"},"Game Over !"):r.a.createElement("div",{className:"grid-board-opponent"},v))}function _(e){var t=Object(l.c)((function(e){return e.game.nextShape})),n=T[t][0],a=t,o=n.map((function(e,t){return e.map((function(e,n){return r.a.createElement(g,{key:"".concat(t).concat(n),classe:e>0?"grid-square-color":"grid-square",color:e>0?a:e})}))}));return r.a.createElement("div",{className:"next-block"},o,r.a.createElement(D,null))}function A(e){Object(l.b)();var t=Object(l.c)((function(e){return e.game})),n=Object(l.c)((function(e){return e.room})),a=Object(l.c)((function(e){return e.socket})),o=Object(l.c)((function(e){return e.auth})),c=r.a.useState(""),u=Object(C.a)(c,2),i=u[0],s=u[1],m=t.score,d=t.isRunning,v=t.gameOver,f=(t.canRestart,document.querySelector("#play-btn"));return r.a.createElement("div",{className:"score-board"},r.a.createElement("div",{className:"info-dev"},"Score: ",m),r.a.createElement("div",{className:"info-dev"},"Level: 1"),(null===o||void 0===o?void 0:o.name)===(null===n||void 0===n?void 0:n.host)?r.a.createElement("div",{className:"controls"},r.a.createElement("button",{id:"play-btn",className:"control-button",onClick:function(){f.blur(),v||d||a.emit("start game")}},d?"Restart":"Start")):r.a.createElement(r.a.Fragment,null),r.a.createElement("div",{className:"chat-room"},r.a.createElement("div",{className:"header-online"},"chat"),r.a.createElement("div",{className:"chat-group"},null===n||void 0===n?void 0:n.messages.map((function(e,t){return r.a.createElement("div",{className:"message",key:t},r.a.createElement("span",{className:"message-sender"},e.sender)," : ",e.msg)}))),r.a.createElement("div",{className:"form-room"},r.a.createElement("input",{type:"text",className:"input-room",placeholder:"type message ...",onChange:function(e){s(e.target.value)},value:i}),r.a.createElement("div",{className:"button-room",onClick:function(){return function(e){a.emit("msg room",e),s("")}(i)}},"SEND"))))}function P(e){var t={UP:38,DOWN:40,LEFT:37,RIGHT:39,ESPACE:32};Object.freeze(t);var n=Object(l.b)(),o=Object(l.c)((function(e){return e.game.isRunning})),c=Object(l.c)((function(e){return e.game.gameOver})),u=Object(l.c)((function(e){return e.socket})),f=function(e){o&&!c&&n(e())},p=function(e){switch(e.keyCode){case t.UP:return void u.emit("move piece",t.UP);case t.DOWN:return void u.emit("move piece",t.DOWN);case t.LEFT:return void u.emit("move piece",t.LEFT);case t.RIGHT:return void u.emit("move piece",t.RIGHT);case t.ESPACE:return void u.emit("move piece",t.ESPACE);default:return}};return Object(a.useEffect)((function(){return window.addEventListener("keydown",p),function(){window.removeEventListener("keydown",p)}}),[o]),r.a.createElement("div",{className:"controls"},r.a.createElement("button",{disabled:!o||c,className:"control-button",onClick:function(){return f(i)}},"Left"),r.a.createElement("button",{disabled:!o||c,className:"control-button",onClick:function(){return f(s)}},"Right"),r.a.createElement("button",{disabled:!o||c,className:"control-button",onClick:function(){return f(m)}},"Rotate"),r.a.createElement("button",{disabled:!o||c,className:"control-button",onClick:function(){return f(d)}},"Down"),r.a.createElement("button",{disabled:!o||c,className:"control-button",onClick:function(){return f(v)}},"Drop"))}function M(e){var t,n=Object(l.c)((function(e){return e.game.isRunning})),a=Object(l.c)((function(e){return e.game.gameOver})),o="message-popup",c={title:"",messages:[]};n&&!a&&(o="message-popup-hidden"),n||(c.title="Waiting to Start !",c.messages=["You can start your game by click in start button","keyboard instrections :","DOWN to move down","UP to rotate piece","RIGHT to move right","LEFT to move left","SPACE to hard drop"]),a&&(c.title="Game Over",c.messages=["You can restart your game by click in restart button"]);var u=null===c||void 0===c||null===(t=c.messages)||void 0===t?void 0:t.map((function(e,t){return r.a.createElement("p",{key:t},e)}));return r.a.createElement("div",{className:o},r.a.createElement("h1",null,c.title),u)}function x(){return r.a.useEffect((function(){return console.log("hi"),function(){console.log("bey")}}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(k,null),r.a.createElement(_,null),r.a.createElement(A,null),r.a.createElement(P,null),r.a.createElement(M,null))}function G(e){var t=Object(l.c)((function(e){return e.error})),n=Object(l.b)();return r.a.createElement(r.a.Fragment,null,t?r.a.createElement("div",{className:"alert-error"},r.a.createElement("h1",{className:"msg-err"},t),r.a.createElement("div",{className:"icon-close",onClick:function(e){n({type:"NoERROR"})}},"x")):null)}var U=n(36);function L(e){var t=Object(a.useState)(""),n=Object(C.a)(t,2),o=n[0],c=n[1],u=Object(l.b)();return r.a.createElement("div",{className:"username-div"},r.a.createElement("label",{htmlFor:"username",className:"username-label"},"User Name :"),r.a.createElement("input",{className:"username-input",id:"username",type:"text",onChange:function(e){c(e.target.value)},placeholder:"enter your username"}),r.a.createElement("button",{type:"submit",className:"submit-button",onClick:function(e){if(o){var t=Object(U.a)("http://10.11.4.4:5000",{withCredentials:!0});document.cookie="name=".concat(o),u(function(e){return{type:"SOCKET_CONNECT",payload:e}}(t)),t.connected||u(E("failed to connect"))}else e.preventDefault(),u(E("you should enter a username first"))}},"ENTER"),r.a.createElement(G,null))}function F(e){var t=Object(l.c)((function(e){return e.rooms})),n=Object(a.useState)(""),o=Object(C.a)(n,2),c=o[0],u=o[1],i=Object(l.c)((function(e){return e.socket}));r.a.useEffect((function(){i&&i.emit("list room")}),[i]);return r.a.createElement("div",{className:"rooms"},r.a.createElement("div",{className:"header-online"},"Rooms"),r.a.createElement("div",{className:"rooms-group"},t.map((function(e,t){return r.a.createElement("div",{key:t,className:"user-online"},e,r.a.createElement("div",{key:"button-"+t,className:"join-room",onClick:function(){return t=e,void(i&&i.emit("join room",t));var t}},"JOIN"))}))),r.a.createElement("div",{className:"form-room"},r.a.createElement("input",{type:"text",className:"input-room",placeholder:"room name",onChange:function(e){u(e.target.value)},value:c}),r.a.createElement("div",{className:"button-room",onClick:function(e){c?(u(""),i&&(i.emit("create room",c),i.emit("list room"))):e.preventDefault()}},"CREATE ROOM")),r.a.createElement(G,null))}function I(e){var t=Object(l.c)((function(e){return e.socket})),n=Object(l.c)((function(e){return e.users}));return Object(a.useEffect)((function(){t&&t.emit("users")}),[t]),r.a.createElement("div",{className:"users-online"},r.a.createElement("div",{className:"header-online"},n.length," users online"),n.map((function(e,t){return r.a.createElement("div",{key:t,className:"user-online"},e,r.a.createElement("div",{className:"dot-online"}))})))}function W(e){var t=Object(a.useState)(""),n=Object(C.a)(t,2),o=n[0],c=n[1],u=Object(l.c)((function(e){return e.socket})),i=Object(l.c)((function(e){return e.messages}));return r.a.createElement("div",{className:"chat"},r.a.createElement("div",{className:"header-online"},"chat"),r.a.createElement("div",{className:"chat-group"},i.map((function(e,t){return r.a.createElement("div",{className:"message",key:t},r.a.createElement("span",{className:"message-sender"},e.sender)," : ",e.msg)}))),r.a.createElement("div",{className:"form-room"},r.a.createElement("input",{type:"text",className:"input-room",placeholder:"type message ...",onChange:function(e){c(e.target.value)},value:o}),r.a.createElement("div",{className:"button-room",onClick:function(e){o?(u.emit("msg game",o),c("")):e.preventDefault()}},"SEND")))}function q(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(I,null),r.a.createElement(F,null),r.a.createElement(W,null))}var H=function(){var e=Object(l.c)((function(e){return e.auth})),t=Object(l.c)((function(e){return e.room})),n=Object(u.f)();return r.a.useEffect((function(){t&&console.log(t.name),n(e?t?"".concat(t.name,"[").concat(e.name,"]"):"/rooms":"/")}),[e,t]),r.a.createElement("div",{className:"App"},r.a.createElement(O,null,r.a.createElement("header",{className:"App-header"},r.a.createElement("h1",{className:"App-title"},"Tetris")),r.a.createElement(u.c,null,r.a.createElement(u.a,{path:"/",element:r.a.createElement(L,null)}),r.a.createElement(u.a,{path:"rooms",element:r.a.createElement(q,null)}),r.a.createElement(u.a,{path:":room[:username]",element:r.a.createElement(x,null)}),r.a.createElement(u.a,{path:"*",element:r.a.createElement(L,null)}))))},V=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,54)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,o=t.getLCP,c=t.getTTFB;n(e),a(e),r(e),o(e),c(e)}))},X=n(28),J=n(29),B=n(3),K=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y(),t=arguments.length>1?arguments[1]:void 0,n=e.shape,a=e.grid,r=e.x,o=e.y,c=e.rotation,l=e.nextShape,u=e.score,i=e.isRunning,s=function(t){var o=R(n,a,r,t,c),s=o.grid;if(o.gameOver){var m=Object(B.a)({},e);return m.shape=0,m.grid=s,Object(B.a)(Object(B.a)({},e),{},{gameOver:!0})}var d=y();return d.grid=s,d.shape=l,d.nextShape=h(),d.score=u,d.isRunning=i,d.score=u+S(s),d},m=function(){var t=o+1;return j(n,a,r,t,c)?Object(B.a)(Object(B.a)({},e),{},{y:t}):s(o)},d=function(){for(var e=o+1;j(n,a,r,e,c);)e++;return s(e-=1)};switch(t.type){case"ROTATE":var v=N(n,c);return j(n,a,r,o,v)?Object(B.a)(Object(B.a)({},e),{},{rotation:v}):e;case"MOVE_RIGHT":return j(n,a,r+1,o,c)?Object(B.a)(Object(B.a)({},e),{},{x:r+1}):e;case"MOVE_LEFT":return j(n,a,r-1,o,c)?Object(B.a)(Object(B.a)({},e),{},{x:r-1}):e;case"MOVE_DOWN":return m();case"RESUME":return Object(B.a)(Object(B.a)({},e),{},{isRunning:!0});case"PAUSE":return Object(B.a)(Object(B.a)({},e),{},{isRunning:!1});case"DROP":return d();case"RESTART":return y();case"UPDATE":return t.payload;default:return e}},Y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"AUTH_LOGIN":return t.payload;case"ADDOP":return Object(B.a)(Object(B.a)({},e),{},{opponent:t.payload});case"LOGOUT":return!1;default:return e}},z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SOCKET_CONNECT":return t.payload;default:return e}},Q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ROOM":return t.payload;case"MSGROOM":return Object(B.a)(Object(B.a)({},e),{},{messages:[].concat(Object(b.a)(e.messages),[t.payload])});case"EXIT_ROOM":return!1;default:return e}},Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ROOMS":return t.payload;default:return e}},$=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ERROR":return t.payload;case"NoERROR":return null;default:return e}},ee=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"USERS":return t.payload;default:return e}},te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MSGS":return[].concat(Object(b.a)(e),[t.payload]);default:return e}},ne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y(),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"RESETOP":return y();case"UPDATEOP":return t.payload;default:return e}},ae=Object(X.a)({game:K,opGame:ne,auth:Y,socket:z,room:Q,rooms:Z,error:$,users:ee,messages:te}),re=Object(X.b)(ae,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(J.a,null,r.a.createElement(l.a,{store:re},r.a.createElement(H,null)))),document.getElementById("root")),V()}},[[37,1,2]]]);
//# sourceMappingURL=main.5002ec78.chunk.js.map